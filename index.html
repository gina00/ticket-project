<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- 上述3个meta标签*必须*放在最前面，任何其他内容都*必须*跟随其后！ -->
    <title>动物检疫票证系统</title>

    <link rel="stylesheet" href="node_modules/layui/css/layui.css">
    <link rel="stylesheet" href="css/layout.css">
    <script src="node_modules/layui/layui.js"></script>
    <script src="js/jquery.min.js"></script>
    <script src="js/nav.js"></script>
</head>

<body>
    <div class="layui-fluid">
        <div class="layui-row banner">
            <div class="logoPanel layui-col-md6">
                <img src="images/logo.png">
            </div>
            <div class="right_box layui-col-md6">
                <a class="loginOut">
                    <i class="icon-login"></i>
                    <span>退出</span>
                </a>
                <div class="userBox" id="showUserBox">
                    <i class="icon-user"></i>
                    <span>欢迎您：</span>
                    <a>admin</a>
                </div>
            </div>

        </div>
        <div class="layui-row">
            <div class="layui-col-md2 left-nav">
                <div id="slide_menu" class="slide_menu"><i class="layui-icon layui-icon-shrink-right"></i></div>
                <ul class="layui-nav layui-nav-tree menu-list" lay-filter="menulist">
                    <li class="layui-nav-item layui-nav-itemed">
                        <a>
                            <i class="icon-taskManagement"></i>
                            <span>
                                待办任务管理
                            </span>
                        </a>
                        <dl class="layui-nav-child">
                            <dd>
                                <a data-url="a" data-id='1' data-title="选项a" data-type="tabAdd"
                                    class="site-demo-active">农业厅二级菜单</a></dd>
                            <dd><a data-url="b" data-id='2' data-title="选项c" data-type="tabAdd"
                                    class="site-demo-active">农业菜单</a></dd>
                        </dl>
                    </li>
                    <li class="layui-nav-item">
                        <a href="javascript:;">
                            <i class="icon-userManagement"></i>
                            <span>农业农村厅用户管理</span>
                        </a>
                        <dl class="layui-nav-child">
                            <dd><a data-url="d" data-id="3" data-title="选b项b" data-type="tabAdd"
                                    class="site-demo-active">农业厅二级菜单</a></dd>
                            <dd><a data-url="c" data-id="4" data-title="选项d" data-type="tabAdd"
                                    class="site-demo-active">农业菜单</a></dd>
                        </dl>
                    </li>
                    <li class="layui-nav-item">
                        <a href="javascript:;">
                            <i class="icon-enterpriseManagement"></i>
                            <span>企业用户管理</span>
                        </a>
                        <dl class="layui-nav-child">
                            <dd><a data-url="a" data-id="5" data-title="选项a1" data-type="tabAdd"
                                    class="site-demo-active">农业厅二级菜单</a></dd>
                            <dd><a data-url="a" data-id="6" data-title="选项a2" data-type="tabAdd"
                                    class="site-demo-active">农业菜单</a></dd>
                        </dl>
                    </li>
                    <li class="layui-nav-item">
                        <a href="javascript:;">
                            <i class="icon-groupManagement"></i>
                            <span>群组管理</span>
                        </a>
                        <dl class="layui-nav-child">
                            <dd><a data-url="a" data-id="7" data-title="选项a" data-type="tabAdd"
                                    class="site-demo-active">农业厅二级菜单</a></dd>
                            <dd><a data-url="a" data-id="8" data-title="选项a" data-type="tabAdd"
                                    class="site-demo-active">农业菜单</a></dd>
                        </dl>
                    </li>
                    <li class="layui-nav-item">
                        <a href="javascript:;">
                            <i class="icon-newsManagement"></i>
                            <span>新闻管理</span>
                        </a>
                        <dl class="layui-nav-child">
                            <dd><a data-url="a" data-id="9" data-title="选项a" data-type="tabAdd"
                                    class="site-demo-active">农业厅二级菜单</a></dd>
                            <dd><a data-url="a" data-id="10" data-title="选项a" data-type="tabAdd"
                                    class="site-demo-active">农业菜单</a></dd>
                        </dl>
                    </li>
                    <li class="layui-nav-item">
                        <a href="javascript:;">
                            <i class="icon-announcementManagement"></i>
                            <span>公告管理</span>
                        </a>
                        <dl class="layui-nav-child">
                            <dd><a data-url="a" data-id="11" data-title="选项a" data-type="tabAdd"
                                    class="site-demo-active">农业厅二级菜单</a></dd>
                            <dd><a data-url="a" data-id="12" data-title="选项a" data-type="tabAdd"
                                    class="site-demo-active">农业菜单</a></dd>
                        </dl>
                    </li>
                    <li class="layui-nav-item">
                        <a href="javascript:;">
                            <i class="icon-QAmanage"></i>
                            <span>Q&A管理</span>
                        </a>
                        <dl class="layui-nav-child">
                            <dd><a data-url="a" data-id="13" data-title="选项a" data-type="tabAdd"
                                    class="site-demo-active">农业厅二级菜单</a></dd>
                            <dd><a data-url="a" data-id="14" data-title="选项a" data-type="tabAdd"
                                    class="site-demo-active">农业菜单</a></dd>
                        </dl>
                    </li>
                    <li class="layui-nav-item">
                        <a href="javascript:;">
                            <i class="icon-mailManagement"></i>
                            <span>邮件管理</span>
                        </a>
                        <dl class="layui-nav-child">
                            <dd><a data-url="a" data-id="15" data-title="选项a" data-type="tabAdd"
                                    class="site-demo-active">农业厅二级菜单</a></dd>
                            <dd><a data-url="a" data-id="16" data-title="选项a" data-type="tabAdd"
                                    class="site-demo-active">农业菜单</a></dd>
                        </dl>
                    </li>
                    <li class="layui-nav-item">
                        <a href="javascript:;">
                            <i class="icon-logManagement"></i>
                            <span>日志管理</span>
                        </a>
                        <dl class="layui-nav-child">
                            <dd><a data-url="a" data-id="17" data-title="选项a" data-type="tabAdd"
                                    class="site-demo-active">农业厅二级菜单</a></dd>
                            <dd><a data-url="a" data-id="18" data-title="选项a" data-type="tabAdd"
                                    class="site-demo-active">农业菜单</a></dd>
                        </dl>
                    </li>
                    <li class="layui-nav-item">
                        <a href="javascript:;">
                            <i class="icon-keyManagement"></i>
                            <span>快捷键管理</span>
                        </a>
                        <dl class="layui-nav-child">
                            <dd><a data-url="a" data-id="19" data-title="选项a" data-type="tabAdd"
                                    class="site-demo-active">农业厅二级菜单</a></dd>
                            <dd><a data-url="a" data-id="20" data-title="选项a" data-type="tabAdd"
                                    class="site-demo-active">农业菜单</a></dd>
                        </dl>
                    </li>
                    <li class="layui-nav-item">
                        <a href="javascript:;">
                            <i class="icon-systemManagement"></i>
                            <span>系统管理</span>
                        </a>
                        <dl class="layui-nav-child">
                            <dd><a data-url="a" data-id="21" data-title="选项a" data-type="tabAdd"
                                    class="site-demo-active">农业厅二级菜单</a></dd>
                            <dd><a data-url="a" data-id="22" data-title="选项a" data-type="tabAdd"
                                    class="site-demo-active">农业菜单</a></dd>
                        </dl>
                    </li>
                </ul>
            </div>
            <div class="layui-col-md10 right_content page-content">
                <div class="layui-row">
                    <div class="layui-col-md12">
                        <div class="layui-tab" lay-allowClose="true" lay-filter="breadbrumb">
                            <ul class="layui-tab-title">
                            </ul>
                            <div class="layui-tab-content">
                                <div class="layui-tab-item layui-show">
                                    <iframe name="menuFrame" id="menuFrame" onload="reinitIframe()"
                                        src="html/rightContent.html" width="100%" frameborder="0" scrolling="no">
                                    </iframe>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>
        var user_menu_rights;
        $(function () {
            bulidMenu();
        })

        function bulidMenu() {
            var html = '';
            var firstArr = [{
                name: '待办任务管理',
                children: [{
                    name: '农业菜单'
                }, {
                    name: '农业菜单'
                }]
            }];
            $.each(firstArr, function (index, item) {
                console.log(item);
                html += "<li class='layui-nav-item'>";
                html += " <a>";
                html += " <i class='icon-taskManagement'></i>";
                html += " <span>" + item.name + "</span>";
                html += " </a>";
                html += " <dl class='layui-nav-child'>";
                    debugger
                html += bulidSubMenu(firstArr.children);
                html += "</dl>";
                html += "</li>";
            })
            $(".menu-list").append(html);
        }

        function bulidSubMenu(arr) {
            var html = '';
            $.each(arr, function (index, item) {
                console.log(item);
                html += " <dd>";
                html += "<a>" + item.name + "</a>";
                html += "</dd>";
            })
            return html;
        }
        // 根据情况扩展下面包屑功能
        layui.use('element', function () {
            var $ = layui.jquery;
            var element = layui.element; //Tab的切换功能，切换事件监听等，需要依赖element模块

            //触发事件
            var active = {
                //在这里给active绑定几项事件，后面可通过active调用这些事件
                tabAdd: function (url, id, name) {
                    //新增一个Tab项 传入三个参数，分别对应其标题，tab页面的地址，还有一个规定的id，是标签中data-id的属性值
                    //关于tabAdd的方法所传入的参数可看layui的开发文档中基础方法部分
                    element.tabAdd('breadbrumb', {
                        title: name,
                        content: '<iframe data-frameid="' + id +
                            '" scrolling="auto" frameborder="0" src="' + url +
                            '.html" style="width:100%;height:99%;" + name="menuFrame" id="menuFrame" onload="reinitIframe()"></iframe>',
                        id: id //规定好的id
                    })
                    FrameWH(); //计算ifram层的大小
                },
                tabChange: function (id) {
                    //切换到指定Tab项
                    element.tabChange('breadbrumb', id); //根据传入的id传入到指定的tab项
                },
                tabDelete: function (id) {
                    element.tabDelete("breadbrumb", id); //删除
                },
                tabDeleteAll: function (ids) { //删除所有
                    $.each(ids, function (i, item) {
                        element.tabDelete("breadbrumb",
                            item); //ids是一个数组，里面存放了多个id，调用tabDelete方法分别删除
                    })
                }
            };

            //当点击有site-demo-active属性的标签时，即左侧菜单栏中内容 ，触发点击事件
            $('.site-demo-active').on('click', function () {
                var dataid = $(this);
                //这时会判断右侧.layui-tab-title属性下的有lay-id属性的li的数目，即已经打开的tab项数目
                if ($(".layui-tab-title li[lay-id]").length <= 0) {
                    //如果比零小，则直接打开新的tab项
                    active.tabAdd(dataid.attr("data-url"), dataid.attr("data-id"), dataid.attr(
                        "data-title"));
                } else {
                    //否则判断该tab项是否以及存在

                    var isData = false; //初始化一个标志，为false说明未打开该tab项 为true则说明已有
                    $.each($(".layui-tab-title li[lay-id]"), function () {
                        //如果点击左侧菜单栏所传入的id 在右侧tab项中的lay-id属性可以找到，则说明该tab项已经打开
                        if ($(this).attr("lay-id") == dataid.attr("data-id")) {
                            isData = true;
                        }
                    })
                    if (isData == false) {
                        var i = 0;
                        //标志为false 新增一个tab项
                        active.tabAdd(dataid.attr("data-url"), dataid.attr("data-id"), dataid.attr(
                            "data-title"));
                    }
                }
                //最后不管是否新增tab，最后都转到要打开的选项页面上
                active.tabChange(dataid.attr("data-id"));
            });

            function FrameWH() {
                var h = $(window).height() - 41 - 10 - 60 - 10 - 44 - 10;
                $("iframe").css("height", h + "px");
            }

            $(window).resize(function () {
                FrameWH();
            })
        });
    </script>
</body>

</html>